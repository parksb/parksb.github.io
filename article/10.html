<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"><title>🦕 공룡책으로 정리하는 운영체제 Ch.6</title><meta name="viewport"content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible"content="ie=edge"><meta name="theme-color"content="#F5F5F5"><meta name="description"content="프로세스는 동시에 실행될 수 있으며, 여러 개의 프로세스가 협력할 때는 프로세스 사이에 데이터가 동기화되지 않는 문제가 발생할 수 있다.Background만약 두 프로세스가 동시에 어떤 변수의 값을 바꾼다면 프로그래머의 의도와는 다른 결과가 나올 것이다. 이처럼 프로세스가 어떤 순서로 데이터에 접근하느냐에 따라 결과 값이..."><link rel="canonical"href="https://parksb.github.io/article/10.html"><meta name="fediverse:creator"content="@parksb@silicon.moe"><meta property="og:title"content="🦕 공룡책으로 정리하는 운영체제 Ch.6: Synchronization "><meta property="og:image"content="https://og-image-parksb.vercel.app/api/parksb-github-io?title=%F0%9F%A6%95%20%EA%B3%B5%EB%A3%A1%EC%B1%85%EC%9C%BC%EB%A1%9C%20%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20Ch.6&subtitle=Synchronization&date=2018.05.04"><meta property="og:description"content="프로세스는 동시에 실행될 수 있으며, 여러 개의 프로세스가 협력할 때는 프로세스 사이에 데이터가 동기화되지 않는 문제가 발생할 수 있다.Background만약 두 프로세스가 동시에 어떤 변수의 값을 바꾼다면 프로그래머의 의도와는 다른 결과가 나올 것이다. 이처럼 프로세스가 어떤 순서로 데이터에 접근하느냐에 따라 결과 값이..."><meta name="twitter:title"content="🦕 공룡책으로 정리하는 운영체제 Ch.6: Synchronization "><meta name="twitter:image"content="https://og-image-parksb.vercel.app/api/parksb-github-io?title=%F0%9F%A6%95%20%EA%B3%B5%EB%A3%A1%EC%B1%85%EC%9C%BC%EB%A1%9C%20%EC%A0%95%EB%A6%AC%ED%95%98%EB%8A%94%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%20Ch.6&subtitle=Synchronization&date=2018.05.04"><meta name="twitter:description"content="프로세스는 동시에 실행될 수 있으며, 여러 개의 프로세스가 협력할 때는 프로세스 사이에 데이터가 동기화되지 않는 문제가 발생할 수 있다.Background만약 두 프로세스가 동시에 어떤 변수의 값을 바꾼다면 프로그래머의 의도와는 다른 결과가 나올 것이다. 이처럼 프로세스가 어떤 순서로 데이터에 접근하느냐에 따라 결과 값이..."><meta name="twitter:card"content="summary_large_image"><link rel="shortcut icon"href="../assets/favicon.ico"type="image/x-icon"><link rel="preload"href="https://cdn.jsdelivr.net/gh/parksb/cdn@master/font/Pretendard/woff2/Pretendard-VF-Distilled.woff2"as="font"type="font/woff2"crossorigin><link rel="preload"href="https://cdn.jsdelivr.net/gh/parksb/cdn@master/font/RobotoMono/woff2/RobotoMono-VF-Distilled.woff2"as="font"type="font/woff2"crossorigin><style>@font-face { font-family: 'Pretendard'; src: url('https://cdn.jsdelivr.net/gh/parksb/cdn@master/font/Pretendard/woff2/Pretendard-VF-Distilled.woff2'), local('Pretendard') format('woff2'); font-display: swap; }
      @font-face { font-family: 'RobotoMono'; src: local('RobotoMono'), url('https://cdn.jsdelivr.net/gh/parksb/cdn@master/font/RobotoMono/woff2/RobotoMono-VF-Distilled.woff2') format('woff2'); font-display: swap; }
      a:hover { color: #005ccc !important; }
      #article-content-container a:hover, #article-content-container a:focus { text-decoration: underline !important; }
      #article-content-container .table-of-contents ul li:before { content: counters(item, ".") ". "; counter-increment: item; }
      #article-content-container .footnotes > .footnotes-list > .footnote-item > span { font-size: 0.9rem; }</style></head><body style="font-family: Pretendard,sans-serif; font-size: 16px; margin: 0; padding: 20px 30px 50px 30px; word-break: keep-all;"><header id="top-container"role="navigation"><nav><a class="special-anchor"href="/"style="color: #000; text-decoration: none; cursor: pointer;"><span class="t1"style="font-size: 1.5rem; font-weight: 800;">박성범</span> <span class="t2"style="font-size: 1rem; font-weight: 400;">Simon Park</span></a></nav></header><main id="main-container"style="max-width: 800px; margin-top: 30px; margin-bottom: 30px;"><article id="article-container"><div class="back-to-article-list"style="font-size: 1rem; margin-bottom: 1rem;"><a href="../articles.html"style="color: #000; text-decoration: none; cursor: pointer;"><span class="symbol"style="font-family: Pretendard,sans-serif;">←</span> Articles</a></div><h1 id="article-title"style="margin: 0; padding: 0; font-size: 1.5rem; font-weight: 700;">🦕 공룡책으로 정리하는 운영체제 Ch.6</h1><h2 id="article-subtitle"style="margin: 0; padding: 0; display: inline; font-size: 1.2rem; font-weight: 400; margin-right: .4rem;">Synchronization</h2><a href="https://github.com/parksb/parksb.github.io/commits/development/_articles/20180504_dinosaur-book-ch6.md"style="color: #000; text-decoration: none; cursor: pointer;"><time id="article-date"style="font-family: RobotoMono,monospace; font-size: .8rem;">2018.05.04<span class="symbol"style="font-family: Pretendard,sans-serif;">↗</span></time></a><section id="article-content-container"style="margin-top: 30px;"><details style="margin: 0; padding: 0; display: inline; margin-bottom: 10px;"><summary style="font-weight: 700; cursor: pointer;">Table of Contents</summary><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;"></p><div class="table-of-contents"style="font-size: 15px;"><ul style="padding: 0; margin-left: 2rem; list-style-type: none; counter-reset: item; margin: 0; padding-left: 1rem;"><li style="line-height: 1.7rem;"><a href="#background"style="text-decoration: none; cursor: pointer; color: #005ccc;">Background</a></li><li style="line-height: 1.7rem;"><a href="#the-critical-section-problem"style="text-decoration: none; cursor: pointer; color: #005ccc;">The Critical-Section Problem</a></li><li style="line-height: 1.7rem;"><a href="#peterson%E2%80%99s-solution"style="text-decoration: none; cursor: pointer; color: #005ccc;">Peterson’s Solution</a></li><li style="line-height: 1.7rem;"><a href="#mutex-locks"style="text-decoration: none; cursor: pointer; color: #005ccc;">Mutex Locks</a></li><li style="line-height: 1.7rem;"><a href="#semaphores"style="text-decoration: none; cursor: pointer; color: #005ccc;">Semaphores</a><ul style="padding: 0; margin-left: 2rem; list-style-type: none; counter-reset: item; margin: 0; padding-left: 1rem;"><li style="line-height: 1.7rem;"><a href="#semaphore-usage"style="text-decoration: none; cursor: pointer; color: #005ccc;">Semaphore Usage</a></li><li style="line-height: 1.7rem;"><a href="#deadlocks-and-starvation"style="text-decoration: none; cursor: pointer; color: #005ccc;">Deadlocks and Starvation</a></li></ul></li><li style="line-height: 1.7rem;"><a href="#classic-problems-of-synchronization"style="text-decoration: none; cursor: pointer; color: #005ccc;">Classic Problems of Synchronization</a></li></ul></div><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;"></p></details><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">프로세스는 동시에 실행될 수 있으며, 여러 개의 프로세스가 협력할 때는 프로세스 사이에 데이터가 동기화되지 않는 문제가 발생할 수 있다.</p><h2 id="background"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">Background</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">만약 두 프로세스가 동시에 어떤 변수의 값을 바꾼다면 프로그래머의 의도와는 다른 결과가 나올 것이다. 이처럼 <strong>프로세스가 어떤 순서로 데이터에 접근하느냐에 따라 결과 값이 달라질 수 있는 상황을 경쟁 상태</strong>(race condition)라고 한다.</p><h2 id="the-critical-section-problem"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">The Critical-Section Problem</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;"><strong>코드상에서 경쟁 조건이 발생할 수 있는 특정 부분을 critical section</strong>이라고 부른다. critical section problem를 해결하기 위해서는 몇가지 조건을 충족해야 한다.</p><ul style="margin: 0; padding: 0; margin-bottom: 1rem; margin-left: 2rem;"><li style="line-height: 1.7rem;">Mutual exclution (상호 배제): 이미 한 프로세스가 critical section에서 작업중일 때 다른 프로세스는 critical section에 진입해서는 안 된다.</li><li style="line-height: 1.7rem;">Progress (진행): critical section에서 작업중인 프로세스가 없다면 다른 프로세스가 critical section에 진입할 수 있어야 한다.</li><li style="line-height: 1.7rem;">Bounded waiting (한정 대기): critical section에 진입하려는 프로세스가 무한하게 대기해서는 안 된다.</li></ul><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">Non-preemptive kernels로 구현하면 임계 영역 문제가 발생하지 않는다. 하지만 비선점 스케줄링은 반응성이 떨어지기 때문에 슈퍼 컴퓨터가 아니고선 잘 사용하지 않는다.</p><h2 id="peterson%E2%80%99s-solution"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">Peterson’s Solution</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">Peterson’s solution으로 임계 영역 문제를 해결할 수 있다. 임계 영역에서 <strong>프로세스가 작업중인지 저장하는 변수</strong> <code style="font-family: RobotoMono,monospace;">flag</code>와 <strong>critical section에 진입하고자하는 프로세스를 가리키는 변수</strong> <code style="font-family: RobotoMono,monospace;">turn</code> 을 만들어 어떤 프로세스가 임계 영역에 진입하면 <code style="font-family: RobotoMono,monospace;">flag</code>를 <code style="font-family: RobotoMono,monospace;">lock</code>하고, 나오면 <code style="font-family: RobotoMono,monospace;">unlock</code>하는 방식으로 임계 영역 문제를 해결한다.</p><pre class="shiki github-light"style="display: block; overflow-x: auto; padding-left: 1rem; margin-bottom: 1rem; line-height: 1.3rem; background-color: #fff; color: #24292e;"tabindex="0"><code class="language-c"style="font-family: RobotoMono,monospace;"><span class="line"><span style="color:#D73A49">do</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#E36209">  flag</span><span style="color:#24292E">[i] </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> true</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">  turn </span><span style="color:#D73A49">=</span><span style="color:#24292E"> j;</span></span>
<span class="line"><span style="color:#D73A49">  while</span><span style="color:#24292E"> (</span><span style="color:#E36209">flag</span><span style="color:#24292E">[j] </span><span style="color:#D73A49">&#x26;&#x26;</span><span style="color:#24292E"> turn </span><span style="color:#D73A49">==</span><span style="color:#24292E"> j);</span></span>
<span class="line"><span style="color:#6A737D">  // Critical section</span></span>
<span class="line"><span style="color:#E36209">  flag</span><span style="color:#24292E">[i] </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> false</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#6A737D">  // Remainder section</span></span>
<span class="line"><span style="color:#24292E">} </span><span style="color:#D73A49">while</span><span style="color:#24292E">(</span><span style="color:#005CC5">true</span><span style="color:#24292E">);</span></span></code></pre><h2 id="mutex-locks"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">Mutex Locks</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">mutex locks은 여러 스레드가 공통 리소스에 접근하는 것을 제어하는 기법으로, <code style="font-family: RobotoMono,monospace;">lock</code>이 하나만 존재할 수 있는 locking 매커니즘을 따른다. (참고로 'mutex’는 'MUTual EXclusion’을 줄인 말이다.) <strong>이미 하나의 스레드가 critical section에서 작업중인 <code style="font-family: RobotoMono,monospace;">lock</code> 상태에서 다른 스레드들은 critical section에 진입할 수 없도록 한다.</strong></p><h2 id="semaphores"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">Semaphores</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">세마포어(Semaphore)는 여러 개의 프로세스나 스레드가 critical section에 진입할 수 있는 locking 매커니즘이다. <strong>세마포어는 카운터를 이용해 동시에 리소스에 접근할 수 있는 프로세스를 제한한다.</strong> 물론 한 프로세스가 값을 변경할 때 다른 프로세스가 동시에 값을 변경하지는 못한다. 세마포어는 P와 V라는 명령으로 접근할 수 있다. (P, V는 try와 increment를 뜻하는 네덜란드어 Proberen과 Verhogen의 머릿글자다.)</p><h3 id="semaphore-usage"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.3rem;">Semaphore Usage</h3><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">세마포어의 카운터가 한 개인 경우 바이너리 세마포어(Binary semaphore), 두 개 이상인 경우 카운팅 세마포어(Counting semaphore)라고 한다. 바이너리 세마포어는 사실상 mutex와 같다.</p><h3 id="deadlocks-and-starvation"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.3rem;">Deadlocks and Starvation</h3><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">두 프로세스가 서로 종료될 때까지 대기하는 프로그램을 실행한다고 생각해보자. 프로세스 A는 B가 종료될 때까지, 프로세스 B는 A가 종료될 때까지 작업을 하지 않기 때문에 프로그램은 어떤 동작도 하지 못할 것이다. 이처럼 <strong>두 프로세스가 리소스를 점유하고 놓아주지 않거나, 어떠한 프로세스도 리소스를 점유하지 못하는 상태가 되어 프로그램이 멈추는 현상을 데드락(Deadlock)이라고 한다.</strong> 운영체제도 결국 소프트웨어이기 때문에 데드락에 빠질 수 있다.</p><h2 id="classic-problems-of-synchronization"tabindex="-1"style="margin: 0; padding: 0; margin-bottom: 1rem; font-weight: 700; font-size: 1.4rem; padding-bottom: 5px; border-bottom: 1px #000 solid;">Classic Problems of Synchronization</h2><p style="font-size: 1rem; line-height: 1.7rem; margin-bottom: 1rem;">데드락에 관한 유명한 비유가 있다. 철학자 5명이 식탁 가운데 음식을 두고 철학자들은 사색과 식사를 반복한다. 포크는 총 5개, 단 음식을 먹으려면 2개의 포크를 사용해야 한다. 즉, 동시에 음식을 먹을 수 있는 사람은 두 명뿐이다. 운이 좋으면 5명의 철학자들이 돌아가면서 사색과 식사를 이어갈 수 있다. 하지만 <strong>모두가 포크를 하나씩 들고 식사를 하려하면 누구도 식사를 할 수 없는 상태</strong>, 다시말해 데드락에 빠져 버린다. 이것이 바로 철학자들의 만찬 문제(Dining-Philosophers Problem)이다.</p></section><section id="article-navigation"style="margin-top: 50px; overflow: hidden;"><div class="article-navigation-item article-navigation-next"style="margin-bottom: 1rem; text-align: left; float: left; margin-right: 5px;"><a href="11.html"style="color: #000; text-decoration: none; cursor: pointer;"><div class="article-navigation-arrow article-navigation-next symbol"style="font-family: Pretendard,sans-serif; font-size: .9rem; text-align: left; float: left; margin-right: 5px;">←</div><div class="article-navigation-content article-navigation-next"style="text-align: left; float: left; margin-right: 5px;"><p class="article-navigation-title"style="font-weight: 700; font-size: 1rem; margin: 0;">🦕 공룡책으로 정리하는 운영체제 Ch.7</p><p class="article-navigation-subtitle"style="font-weight: 400; font-size: .8rem; margin: 0;">Deadlocks</p></div></a></div><div class="article-navigation-item article-navigation-prev"style="margin-bottom: 1rem; text-align: right; float: right; margin-left: 5px;"><a href="9.html"style="color: #000; text-decoration: none; cursor: pointer;"><div class="article-navigation-arrow article-navigation-prev symbol"style="font-family: Pretendard,sans-serif; font-size: .9rem; text-align: right; float: right; margin-left: 5px;">→</div><div class="article-navigation-content article-navigation-prev"style="text-align: right; float: right; margin-left: 5px;"><p class="article-navigation-title"style="font-weight: 700; font-size: 1rem; margin: 0;">🦕 공룡책으로 정리하는 운영체제 Ch.5</p><p class="article-navigation-subtitle"style="font-weight: 400; font-size: .8rem; margin: 0;">Process Scheduling</p></div></a></div></section><section id="article-comments"><script async src="https://utteranc.es/client.js"repo="parksb/parksb.github.io-comments"issue-term="pathname"theme="github-light"crossorigin="anonymous"></script></section><div class="back-to-article-list"style="font-size: 1rem; margin-bottom: 1rem;"><a href="../articles.html"style="color: #000; text-decoration: none; cursor: pointer;"><span class="symbol"style="font-family: Pretendard,sans-serif;">←</span> Articles</a></div></article></main><footer style="font-size: .8rem; color: #767676;">이 글은 CC BY-NC 4.0 라이선스에 따라 이용할 수 있습니다.</footer><script async src="https://www.googletagmanager.com/gtag/js?id=G-LKTJ5YFJR2"></script><script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LKTJ5YFJR2');</script></body></html>