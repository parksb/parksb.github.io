---
id: 38
title: "ğŸ§± Server Driven UI ì„¤ê³„ë¥¼ í†µí•œ UI ìœ ì—°í™”"
subtitle: "í´ë¼ì´ì–¸íŠ¸ ë°°í¬ì—†ì´ í™”ë©´ êµ¬ì„± ë³€ê²½í•˜ê¸°"
date: "2021.07.09"
---

ì›¹ê³¼ ë‹¬ë¦¬ ë„¤ì´í‹°ë¸Œ ëª¨ë°”ì¼ ì•±ì€ ë¹Œë“œ, ë°°í¬ í›„ì—ëŠ” ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë§Œì•½ ì˜ëª»ëœ ìœ„ì¹˜ì— ë²„íŠ¼ì„ ë°°ì¹˜í•œ ì±„ë¡œ ìŠ¤í† ì–´ì— ì•±ì„ ë°°í¬í–ˆë‹¤ë©´, ê·¸ë¦¬ê³  ì‚¬ìš©ìê°€ ì˜ëª»ëœ ë²„ì „ì˜ ì•±ì„ ì„¤ì¹˜í–ˆë‹¤ë©´ ë²„íŠ¼ì˜ ìœ„ì¹˜ë¥¼ ìˆ˜ì •í•  ë°©ë²•ì´ ì—†ë‹¤. ìœ ì¼í•œ ë°©ë²•ì€ ì‚¬ìš©ìê°€ ìŠ¤ìŠ¤ë¡œ ìŠ¤í† ì–´ì— ë“¤ì–´ê°€ ìˆ˜ì •ëœ ë²„ì „ì˜ ì•±ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” ê²ƒ ë¿ì´ë‹¤.

ë°°í¬ í›„ ìˆ˜ì •ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ëŠ” íŠ¹ì„±ì´ ë¶€ë”ªíˆëŠ” ë˜ ë‹¤ë¥¸ ìƒí™©ì€ A/B í…ŒìŠ¤íŒ…ì´ë‹¤. ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ ì¼ì–´ë‚˜ëŠ” ì‚¬ìš©ìì˜ í–‰ë™ê³¼ ê²½í—˜ì€ í™”ë©´ êµ¬ì„±ì´ë‚˜ ë¬¸êµ¬ì— ë”°ë¼ í¬ê²Œ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì— ìµœì ì˜ í™”ë©´ì„ ë””ìì¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ê·¸ëŸ°ë° ì‚¬ìš©ìì˜ í–‰ë™ê³¼ ê²½í—˜ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë ¤ìš´ ì¼ì´ê¸° ë•Œë¬¸ì— í˜„ì‹¤ì˜ ì‚¬ìš©ìë“¤ì—ê²Œ ë‹¤ì–‘í•œ ìœ í˜•ì˜ UIë¥¼ ì œê³µí•˜ê³ , ì–´ë–¤ UIê°€ ì í•©í•œì§€ ì‹¤ì¸¡í•  í•„ìš”ê°€ ìˆë‹¤. ì‹¤ì œë¡œ ë§ì€ ì†Œí”„íŠ¸ì›¨ì–´ ê¸°ì—…ë“¤ì´ ì‚¬ìš©ìë¥¼ A, B ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ê³  (ë” ë§ì€ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ë„ ìˆë‹¤.) ê° ê·¸ë£¹ì—ê²Œ ì„œë¡œ ë‹¤ë¥¸ UIë¥¼ ì œê³µí•´ ê°€ì¥ ì í•©í•œ UIë¥¼ ì„ ì •í•˜ëŠ” A/B í…ŒìŠ¤íŒ…ì„ í•˜ê³  ìˆë‹¤.

ìœ ì—°í•œ UIë¥¼ ì œê³µí•˜ë ¤ë©´ UIê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ë¹Œë“œì™€ ë°°í¬ë¡œë¶€í„° ììœ ë¡œì›Œì•¼ í•œë‹¤. ì´ëŸ¬í•œ ëª©í‘œë¥¼ ì´ë£¨ê¸° ìœ„í•´ ì›¹ë·°ì™€ ê°™ì´ ë„¤ì´í‹°ë¸Œ í™˜ê²½ì„ ë²—ì–´ë‚œ ë‹¤ì–‘í•œ ë°©ë²•ì„ ì„ íƒí•  ìˆ˜ë„ ìˆê² ì§€ë§Œ, í˜„ì‹¤ì—ì„œëŠ” ë‹¤ì–‘í•œ ì´ìœ ë¡œ ì›¹ë·°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ìƒí™©ì´ ìˆë‹¤. ì´ ê¸€ì—ì„œëŠ” ì›¹ë·°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì „ì œ í•˜ì— ìœ ì—°í•˜ê²Œ UIë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ Server Driven UI ì„¤ê³„ì— ëŒ€í•´ ì†Œê°œí•˜ê³ ì í•œë‹¤.

## ì„œë²„ì—ì„œ UI ë‹¤ë£¨ê¸°

í´ë¼ì´ì–¸íŠ¸ê³¼ ë‹¬ë¦¬ ì„œë²„ëŠ” ì–¸ì œë“  ë³€ê²½, ë°°í¬í•  ìˆ˜ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì„œë²„ì—ì„œ ì œê³µí•˜ëŠ” APIë¥¼ ì´ìš©í•´ ë™ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ UIë¥¼ êµ¬ì„±í•˜ë©´ ì–´ë–¨ê¹Œ? ì„œë²„ê°€ API ì‘ë‹µì— UI ì •ë³´ë¥¼ ë‹´ì•„ í´ë¼ì´ì–¸íŠ¸ì— ì œê³µí•˜ê³ , í´ë¼ì´ì–¸íŠ¸ê°€ API ì‘ë‹µì— ë”°ë¼ í™”ë©´ì„ ë Œë”ë§í•œë‹¤ë©´ ì„œë²„ì—ì„œ API ì‘ë‹µì„ ë³€ê²½í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì˜ í™”ë©´ êµ¬ì„±ì„ ë™ì ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ìš©ìì—ê²Œ í™ˆ í™”ë©´ì„ ì œê³µí•˜ëŠ” ê²½ìš°, ì„œë²„ê°€ ì œê³µí•˜ëŠ” REST API `screen`ì„ í†µí•´ `home` í™”ë©´ì— ëŒ€í•œ UI ì •ë³´ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

```
GET /screen/home
```

ì´ APIëŠ” í™ˆ í™”ë©´ì„ êµ¬ì„±í•˜ëŠ” UI ìš”ì†Œ ë¦¬ìŠ¤íŠ¸ë¥¼ JSON í¬ë§·ìœ¼ë¡œ ì‘ë‹µí•œë‹¤. ë”°ë¼ì„œ í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì˜ `data` ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ê°ê°ì˜ `type`ì— í•´ë‹¹í•˜ëŠ” UI ìš”ì†Œë¥¼ í™”ë©´ì— ê·¸ë ¤ì£¼ë©´ ëœë‹¤.

![ì•±ë°”, í…ìŠ¤íŠ¸ ë²„íŠ¼ 2ê°œê°€ ë°°ì¹˜ëœ í™”ë©´.](/images/124375746-bf951100-dcde-11eb-8b50-9362fbf46ff9.webp)

ì´ë ‡ê²Œ í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ë¥¼ ìƒˆë¡œ ë°°í¬í•˜ì§€ ì•Šì•„ë„ ì„œë²„ì—ì„œ `data` ë¦¬ìŠ¤íŠ¸ì˜ ìš”ì†Œë¥¼ ë³€ê²½í•¨ìœ¼ë¡œì¨ í´ë¼ì´ì–¸íŠ¸ê°€ ìœ ì—°í•œ UIë¥¼ ì œê³µí•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì´ì²˜ëŸ¼ UIì— ëŒ€í•œ ì •ë³´ë¥¼ ì„œë²„ì—ì„œ ê´€ë¦¬, ì œê³µí•˜ëŠ” ê²ƒì´ Server Driven UI ì„¤ê³„ì˜ ê¸°ë³¸ ê°œë…ì´ë‹¤.

## GraphQL: ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸ ì œê³µí•˜ê¸°

ì„œë²„ì—ì„œ UIë¥¼ ê´€ë¦¬í•˜ë©´ ìœ ì—°ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆì§€ë§Œ, ì‚¬ìš©í•˜ëŠ” UI ìš”ì†Œì˜ ì¬ì‚¬ìš©ì„±ì„ ê³ ë ¤í•˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì–‘í•œ í™”ë©´ì—ì„œ UI ìš”ì†Œë¥¼ êµì²´í•˜ê¸° ì–´ë ¤ì›Œì§„ë‹¤. ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í”¼í•˜ë ¤ë©´ ëª¨ë“  UI ìš”ì†Œë¥¼ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì»´í¬ë„ŒíŠ¸ë¡œ êµ¬ì„±í•˜ê³ , UI ì»´í¬ë„ŒíŠ¸ë¥¼ ë‹¤ì–‘í•œ í™”ë©´ì—ì„œ ì¡°ë¦½í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

ë˜í•œ ìˆ˜ì‹œë¡œ í™”ë©´ì— ìƒˆë¡œìš´ ì»´í¬ë„ŒíŠ¸ê°€ ì¶”ê°€ë˜ê³  ì œê±°ë˜ë©´ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ì˜ íƒ€ì… ì •ì˜ì— ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•˜ê¸° ì‰½ë‹¤. ì´ë•Œ GraphQLì„ ì‚¬ìš©í•˜ë©´ ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ê°€ ê³µìœ í•˜ëŠ” ìŠ¤í‚¤ë§ˆë¥¼ í†µí•´ APIì˜ íƒ€ì… ì•ˆì „ì„±ì„ ë³´ì¥í•  ìˆ˜ ìˆë‹¤.

### ì¿¼ë¦¬ ì„¤ê³„

ì„œë²„ëŠ” UI ì»´í¬ë„ŒíŠ¸ ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•˜ëŠ” `screen` ì¿¼ë¦¬ë¥¼ í†µí•´ íŠ¹ì • í™”ë©´ì— ëŒ€í•œ UI ì •ë³´ë¥¼ ì œê³µí•œë‹¤.

```graphql
type Query {
  screen(screenType: ScreenType!): Screen!
}

enum ScreenType {
  HOME
  SIGN_IN
}

type Screen {
  components: [Component!]!
}
```

í´ë¼ì´ì–¸íŠ¸ëŠ” `screen` ì¿¼ë¦¬ë¥¼ í˜¸ì¶œí•˜ë©° í™ˆ í™”ë©´ì—ì„œëŠ” `screenType: HOME` ì¸ìë¥¼, ë¡œê·¸ì¸ í™”ë©´ì—ì„œëŠ” `screenType: SIGN_IN` ì¸ìë¥¼ ì „ë‹¬í•  ê²ƒì´ë‹¤. ì„œë²„ëŠ” ì¿¼ë¦¬ë¥¼ ë°›ìœ¼ë©´ í•´ë‹¹ `screenType`ì— ë§ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì¡°í•©í•˜ì—¬ `Screen` íƒ€ì…ì˜ `components` í•„ë“œì— `Component` ë¦¬ìŠ¤íŠ¸ë¥¼ ë‹´ì•„ ì‘ë‹µí•œë‹¤.

`Component`ëŠ” ìœ ë‹ˆì˜¨ íƒ€ì…ì´ë‹¤. ìœ ë‹ˆì˜¨ íƒ€ì…ì€ ë‹¤ì–‘í•œ íƒ€ì…ì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ `Component`ë¼ëŠ” í•˜ë‚˜ì˜ íƒ€ì…ìœ¼ë¡œ ë‹¤ë£° ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. `Screen` íƒ€ì…ì˜ `components` í•„ë“œê°€ `Component` ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•œë‹¤ëŠ” ê²ƒì€ ë¦¬ìŠ¤íŠ¸ ì•ˆì— `AppBar`, `TextButton`, `Image` íƒ€ì…ì´ ì„ì¼ ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸ë‹¤.

```graphql
union Component = AppBar | TextButton | Image

type AppBar {
  title: String!
}

type TextButton {
  text: String!
  route: String
}

type Image {
  url: String!
}
```

ë§Œì•½ ì»´í¬ë„ŒíŠ¸ë“¤ì´ ê³µí†µ í•„ë“œë¥¼ ê°€ì§„ë‹¤ë©´ `Component`ë¥¼ ìœ ë‹ˆì˜¨ íƒ€ì… ëŒ€ì‹  ì¸í„°í˜ì´ìŠ¤ë¡œ ë§Œë“¤ì–´ë„ ëœë‹¤.

```graphql
interface Component {
  position: Int!
}

type AppBar implements Component {
  position: Int!
  title: String!
}

type TextButton implements Component {
  position: Int!
  text: String!
  route: String
}

type Image implements Component {
  position: Int!
  url: String!
}
```

ìœ ë‹ˆì˜¨ íƒ€ì…ì€ ë‹¨ìˆœíˆ ë…ë¦½ì ì¸ ì»´í¬ë„ŒíŠ¸ íƒ€ì…ë“¤ì„ í•˜ë‚˜ì˜ íƒ€ì…ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ë°©ì‹ì´ì—ˆë‹¤ë©´, ì¸í„°í˜ì´ìŠ¤ëŠ” ê°ê°ì˜ ì»´í¬ë„ŒíŠ¸ íƒ€ì…ë“¤ì´ ì¶”ìƒ íƒ€ì…ì¸ `Component`ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ì‹ì´ê¸° ë•Œë¬¸ì— ì–´ë–¤ íƒ€ì…ì´ UI ì»´í¬ë„ŒíŠ¸ì¸ì§€ ëª…í™•í•´ì§„ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

### ìš”ì²­ê³¼ ì‘ë‹µ

GraphQLì˜ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í•„ë“œ ë¬¶ìŒì¸ í”„ë˜ê·¸ë¨¼íŠ¸(Fragment)ëŠ” UI ì»´í¬ë„ŒíŠ¸ë¥¼ ì£¼ê³ ë°›ê¸°ì— ë§¤ìš° ì í•©í•˜ë‹¤. í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì»´í¬ë„ŒíŠ¸ë¥¼ ìš”ì²­í•  ë•ŒëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ìš”ì²­í•  ê²ƒì´ë‹¤.

```graphql
query fetchScreen {
  screen(screenType: HOME) {
    components {
      ... on AppBar {
        __typename
        title
      }
      ... on TextButton {
        __typename
        text
        route
      }
      ... on Image {
        __typename
        url
      }
    }
  }
}
```

ì£¼ì˜í•  ì ì€ 'ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸'ë¥¼ ìš”ì²­í•œë‹¤ëŠ” ì ì´ë‹¤. ë§Œì•½ êµ¬í˜„ ë‹¹ì‹œì— ì‚¬ìš©í•  ì»´í¬ë„ŒíŠ¸ë§Œ ìš”ì²­í•˜ë©´ ì°¨í›„ ì„œë²„ì—ì„œ ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¥¼ í™”ë©´ì— ì¶”ê°€í•´ë„ ë³´ì—¬ì¤„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.

ìš”ì²­ì„ ë°›ì€ ì„œë²„ëŠ” í™ˆ í™”ë©´ì—ì„œ ì‚¬ìš©í•  ì»´í¬ë„ŒíŠ¸ë¥¼ ê³¨ë¼ì„œ ë°˜í™˜í•œë‹¤. ì´ ì˜ˆì‹œì—ì„œëŠ” í™ˆ í™”ë©´ì— `AppBar` ì»´í¬ë„ŒíŠ¸ í•˜ë‚˜ì™€ `TextButton` ì»´í¬ë„ŒíŠ¸ ë‘ ê°œë¥¼ ì‘ë‹µí•œë‹¤.

```rust
impl QueryRoot {
    fn screen(screen_type: ScreenType) -> FieldResult<Screen> {
        Ok(
            Screen {
                components: match screen_type {
                    ScreenType::Home => home_components(),
                    ScreenType::SignIn => sign_in_components(),
                }
            }
        )
    }
}

fn home_components() -> Vec<Component> {
    vec![
        Component::AppBar(AppBar {
            title: "Home".to_string(),
        }),
        Component::TextButton(TextButton {
            text: "Sign in".to_string(),
            route: Some("/sign_in".to_string()),
        }),
        Component::TextButton(TextButton {
            text: "Sign up".to_string(),
            route: None,
        }),
    ]
}
``` 

ëŸ¬ìŠ¤íŠ¸ë¡œ ì„œë²„ ì½”ë“œë¥¼ ì‘ì„±í•œ ì´ìœ ëŠ” ìˆœì „íˆ ê°œì¸ ì·¨í–¥ì´ë©°, Server Driven UIë‚˜ GraphQLê³¼ëŠ” ì „í˜€ ê´€ë ¨ì´ ì—†ë‹¤. ë‹¤ì–‘í•œ ì–¸ì–´ë¡œ ëœ GraphQL API ì„œë²„ êµ¬í˜„ì²´ê°€ ìˆê¸° ë•Œë¬¸ì— ì–¸ì–´ì˜ ì„ íƒì€ ë¬¸ì œê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤.[^graphql-code]

ìš”ì²­ì´ ì„±ê³µí•˜ë©´ ì„œë²„ì—ì„œ ì˜ë„í•œ GraphQL ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆë‹¤.

```json
{
  "data": {
    "screen": {
      "components": [
        {
          "__typename": "AppBar",
          "title": "Home"
        },
        {
          "__typename": "TextButton",
          "text": "Sign in",
          "route": "/sign_in"
        },
        {
          "__typename": "TextButton",
          "text": "Sign up",
          "route": null
        }
      ]
    }
  }
}
```

ì•ì„œ í´ë¼ì´ì–¸íŠ¸ê°€ `components` í•„ë“œ ì•„ë˜ì— `Image` í”„ë˜ê·¸ë¨¼íŠ¸ë„ ìš”ì²­í–ˆì§€ë§Œ, ì„œë²„ê°€ `Image` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ë‹µí•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— ë¦¬ìŠ¤íŠ¸ì—ëŠ” í¬í•¨ë˜ì§€ ì•Šì•˜ë‹¤. ë°˜ëŒ€ë¡œ ì„œë²„ê°€ `Image` ì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ë‹µí–ˆì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•˜ì§€ ê²½ìš°ì—ë„ ë¦¬ìŠ¤íŠ¸ì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ì„œë²„ê°€ ì‹ ê·œ ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í•˜ê±°ë‚˜ ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ì— ì‹ ê·œ í•„ë“œë¥¼ ì¶”ê°€í•´ë„ êµ¬ë²„ì „ í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ì‹ ê·œ ì»´í¬ë„ŒíŠ¸ì™€ í•„ë“œë¥¼ ìš”ì²­í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ì˜ í•˜ìœ„í˜¸í™˜ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆë‹¤. ë‹¨, ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ì— ëŒ€í•´ êµ¬ë²„ì „ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš© ì¤‘ì¸ í•„ë“œë¥¼ ì œê±°í•˜ê±°ë‚˜ non-nullable í•„ë“œë¥¼ nullable í•„ë“œë¡œ ë°”ê¾¸ëŠ” ê²½ìš° í•˜ìœ„í˜¸í™˜ì„±ì´ ê¹¨ì§€ë¯€ë¡œ ì£¼ì˜í•´ì•¼ í•œë‹¤. 

## Flutter: ê²¬ê³ í•œ ë””ìì¸ ì‹œìŠ¤í…œê³¼ ìœ„ì ¯ìœ¼ë¡œ í™”ë©´ ê·¸ë¦¬ê¸°

í†µì¼ê°ìˆëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë””ìì¸ ì‹œìŠ¤í…œì´ ì˜ ì¡í˜€ ìˆì–´ì•¼ í•œë‹¤. ë§Œì•½ UI ë ˆë²¨ì—ì„œ ë””ìì¸ ì‹œìŠ¤í…œì´ ì •ë¦½ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ì• ì´ˆì— ì»´í¬ë„ŒíŠ¸ë¥¼ ê°œë…ì„ ë„ì…í•˜ëŠ” ê²ƒì´ ì–´ë¶ˆì„±ì„¤ì¼ ë¿ë”ëŸ¬, ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸, ë””ìì¸ ì‚¬ì´ì— ì‚¬ìš©í•˜ëŠ” ìš©ì–´ê°€ ë‹¬ë¼ì ¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ë¹„ìš©ë„ ì¦ê°€í•œë‹¤. 

í”ŒëŸ¬í„°(Flutter)ì˜ [ë¨¸í‹°ë¦¬ì–¼ ë¼ì´ë¸ŒëŸ¬ë¦¬(Material Library)](https://api.flutter.dev/flutter/material/material-library.html)ëŠ” êµ¬ê¸€ì˜ ë¨¸í‹°ë¦¬ì–¼ ë””ìì¸ ì‹œìŠ¤í…œì„ ë†’ì€ ìˆ˜ì¤€ìœ¼ë¡œ êµ¬í˜„í•˜ê³  ìˆì–´ Server Driven UIë¥¼ ë°”ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.

![í”ŒëŸ¬í„° ë¨¸í‹°ë¦¬ì–¼ ì»´í¬ë„ŒíŠ¸ ìœ„ì ¯ ëª©ë¡: Appbar, BottomNavigationBar, Drawer.](/images/123917302-995d3180-d9bd-11eb-8c4f-706ee9e92565.webp)

### í”„ë˜ê·¸ë¨¼íŠ¸-ì»´í¬ë„ŒíŠ¸-ìœ„ì ¯ ëŒ€ì‘

í”ŒëŸ¬í„°ê°€ ê°€ì§„ ìœ„ì ¯(Widget) ê°œë…ì´ ì»´í¬ë„ŒíŠ¸ ê°œë…ê³¼ ë¶€í•©í•œë‹¤ëŠ” ì ë„ Server Driven UI ì„¤ê³„ì™€ ì˜ ë§ëŠ”ë‹¤. í”ŒëŸ¬í„°ì˜ ìœ„ì ¯ì€ ì›¹ í”„ë¡ íŠ¸ì—”ë“œ í”„ë ˆì„ì›Œí¬ì¸ ë¦¬ì•¡íŠ¸(React)ì˜ ì»´í¬ë„ŒíŠ¸ ì‹œìŠ¤í…œìœ¼ë¡œë¶€í„° ì˜ê°ì„ ë°›ì•„ ë§Œë“¤ì–´ì¡Œìœ¼ë©°, ê° ìœ„ì ¯ì€ ìì‹ ì˜ í˜„ì¬ ìƒíƒœì— ë”°ë¥¸ UIë¥¼ í‘œí˜„í•œë‹¤.[^flutter-widget]

í´ë¼ì´ì–¸íŠ¸ì˜ ì¶”ìƒ í´ë˜ìŠ¤ `Component`ëŠ” ì„œë²„ì—ì„œ ì‘ë‹µí•˜ëŠ” GraphQL ìœ ë‹ˆì˜¨ íƒ€ì… `Component`ì— ëŒ€ì‘ëœë‹¤. `Component`ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ëŠ” ìœ„ì ¯ì„ ë°˜í™˜í•˜ëŠ” `compose` ë©”ì„œë“œë¥¼ í•¨ê»˜ êµ¬í˜„í•´ì•¼ í•œë‹¤.

```dart
abstract class Component {
  Widget compose(Map<String, dynamic> args, BuildContext context);
}
```

ê°€ë ¹ ì•± ìƒë‹¨ì— ë“¤ì–´ê°€ëŠ” ì•±ë°” UIë¥¼ ì˜ë¯¸í•˜ëŠ” `AppBarComponent`ëŠ” `Component` í´ë˜ìŠ¤ë¥¼ êµ¬í˜„í•˜ë©°, [`AppBar`](https://api.flutter.dev/flutter/material/AppBar-class.html) ìœ„ì ¯ì„ ë°˜í™˜í•˜ëŠ” `compose` ë©”ì„œë“œë¥¼ ê°–ëŠ”ë‹¤.

```dart
class AppBarComponent implements Component {
  Widget compose(Map<String, dynamic> args, BuildContext context) {
    return AppBar(
      title: Text(args['title']),
    );
  }
}
```

`compose` ë©”ì„œë“œëŠ” `args` ì¸ìì˜ `title` í”„ë¡œí¼í‹°ì— ì ‘ê·¼í•´ ì•±ë°”ì˜ íƒ€ì´í‹€ì„ ì±„ìš´ë‹¤. ì´ë•Œ `args` ì¸ìëŠ” ì„œë²„ì˜ ì‘ë‹µì— í¬í•¨ë˜ëŠ” `AppBar` í”„ë˜ê·¸ë¨¼íŠ¸ì˜ í•„ë“œë“¤ì´ `Map<String, dynamic>` íƒ€ì…ìœ¼ë¡œ ì „ë‹¬ë  ê²ƒì´ë‹¤.

í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ë¡œë¶€í„° ë°›ì€ ì‘ë‹µì„ íŒŒì‹±í•œ ë‹¤ìŒ, `components` í•„ë“œì— í¬í•¨ëœ ê°ê°ì˜ í”„ë˜ê·¸ë¨¼íŠ¸ë“¤ì„ ìì‹ ì˜ ì»´í¬ë„ŒíŠ¸ì— ëŒ€ì‘ì‹œí‚¤ê³ , ê° ì»´í¬ë„ŒíŠ¸ì˜ ìœ„ì ¯ì— ëŒ€ì‘ì‹œí‚¤ë ¤ë©´ GraphQL ìŠ¤í‚¤ë§ˆë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì»´í¬ë„ŒíŠ¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ê°€ í•„ìš”í•˜ë‹¤.

```dart
class Registry {
  static final Map<String, Component> _dictionary = {
    'AppBar': AppBarComponent(),
    'TextField': TextFieldComponent(),
    'Image': ImageComponent(),
  };

  static Widget getComponent(dynamic component, BuildContext context) {
    var matchedComponent = _dictionary[component['__typename']];
    if (matchedComponent != null) {
      return matchedComponent.compose(component, context);
    } else {
      return null;
    }
  }

  static List<Widget> getComponents(dynamic components, BuildContext context) {
    var matchedComponent = components as List<dynamic>;
    return matchedComponent.map((component) => getComponent(component, context))
        .where((element) => element != null)
        .toList();
  }
}
```

í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ìœ„ì ¯ ë¦¬ìŠ¤íŠ¸ë¥¼ ì–»ê¸° ìœ„í•´ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ `getComponents` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê³ , `components` í•„ë“œë¥¼ ìˆœíšŒí•˜ë©° `getComponent` ë©”ì„œë“œë¥¼ í†µí•´ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ìœ„ì ¯ìœ¼ë¡œ ë³€í™˜í•œë‹¤.

`getCompnent` ë©”ì„œë“œëŠ” í”„ë˜ê·¸ë¨¼íŠ¸ì— í¬í•¨ëœ ë©”íƒ€ í•„ë“œ `__typename` ê°’ì„ ì´ìš©í•´ ê° í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ì»´í¬ë„ŒíŠ¸ì— ëŒ€ì‘ì‹œí‚¤ê³ , í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ì˜ `compose` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ ì»´í¬ë„ŒíŠ¸ ê°ê°ì˜ ìœ„ì ¯ì„ ë°˜í™˜í•œë‹¤. ë§Œì•½ í´ë¼ì´ì–¸íŠ¸ê°€ ëª¨ë¥´ëŠ”(`_dictionary`ì— ë“±ë¡ë˜ì§€ ì•Šì€) ì»´í¬ë„ŒíŠ¸ê°€ ì‘ë‹µì— í¬í•¨ë˜ì–´ ìˆë‹¤ë©´ í•„í„°ë§ë  ê²ƒì´ë‹¤.

### ì»´í¬ë„ŒíŠ¸ ì¡°ë¦½

ì•ì„œ ì‚´í´ë³¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì´ìš©í•´ ì„œë²„ì—ì„œ ì‘ë‹µí•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ìœ„ì ¯ìœ¼ë¡œ ë³€í™˜í•˜ê³ , ê° í™”ë©´ì— ë§ëŠ” ìœ„ì ¯ì„ êµ¬ì„±í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. ì§€ê¸ˆê¹Œì§€ì˜ íë¦„ì„ ì„œë²„, API ì‘ë‹µ, í´ë¼ì´ì–¸íŠ¸ë¡œ ì •ë¦¬í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤. 

![ì„œë²„, GraphQL ì‘ë‹µ, í´ë¼ì´ì–¸íŠ¸ íë¦„ ë„ì‹.](/images/124376806-afcbfb80-dce3-11eb-8661-6cebf1f787c5.webp)

í”ŒëŸ¬í„° ìœ„ì ¯ ì¤‘ [`Container`](https://api.flutter.dev/flutter/widgets/Container-class.html)ì´ë‚˜ [`Column`](https://api.flutter.dev/flutter/widgets/Column-class.html)ê³¼ ê°™ì´ ë‹¤ë¥¸ ìœ„ì ¯ì„ `child` ë˜ëŠ” `children`ìœ¼ë¡œ ë‹´ëŠ” ìœ„ì ¯ë„ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì¼ì¢…ì˜ 'ì»´í¬ë„ŒíŠ¸ì˜ ì»´í¬ë„ŒíŠ¸'ì¸ ì…ˆì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ [`GridView`](https://api.flutter.dev/flutter/widgets/GridView-class.html) ìœ„ì ¯ì„ ìƒê°í•´ë³´ì. ê·¸ë¦¬ë“œ ë·°ëŠ” ê²©ì ì…€ì´ ë°˜ë³µë˜ëŠ” ë ˆì´ì•„ì›ƒìœ¼ë¡œ, ê° ì…€ì—ëŠ” ë‹¤ë¥¸ ìœ„ì ¯ì„ ë°°ì¹˜ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ê·¸ë¦¬ë“œì˜ ì—´ ê°œìˆ˜ì™€ ê° ì…€ì— ë„£ì„ ì»´í¬ë„ŒíŠ¸ë¥¼ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ê³ ì í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ìŠ¤í‚¤ë§ˆë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.

```graphql
type GridView {
  column_count: Int!
  chidren: [Component!]!
}
```

í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìš”ì²­í•  ë•ŒëŠ” `GridView` í”„ë˜ê·¸ë¨¼íŠ¸ì˜ `children` í•„ë“œ ì•„ë˜ì— ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ë¥¼ ìš”ì²­í•´ì•¼ í•œë‹¤. ê°™ì€ í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ì¬ì‚¬ìš©í•˜ë¯€ë¡œ ì¸ë¼ì¸ í”„ë˜ê·¸ë¨¼íŠ¸ ëŒ€ì‹  ë³„ë„ì˜ ê¸°ëª… í”„ë˜ê·¸ë¨¼íŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤.

```graphql
query fetchScreen {
  screen(screenType: HOME) {
    components {
      ... AppBar
      ... TextButton
      ... Image
      ... on GridView {
        __typename
        column_count
        children {
          ... AppBar
          ... TextButton
          ... Image
        }
      }
    }
  }
}

fragment AppBar on AppBar {
  __typename
  title
}

fragment TextButton on TextButton {
  __typename
  text
  route
}

fragment Image on Image {
  __typename
  url
}
```

ë§ˆì§€ë§‰ìœ¼ë¡œ `GridVew` ìœ„ì ¯ì„ ë°˜í™˜í•˜ëŠ” `GridViewComponent`ëŠ” ìì‹ ì˜ `children` í•„ë“œ ê°’ì„ `getComponents`ë¡œ ë„˜ê²¨ ìœ„ì ¯ ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬ì„±í•œë‹¤.

```dart
class GridViewComponent implements Component {
  Widget compose(Map<String, dynamic> args, BuildContext context) {
    return Expanded(
      child: GridView.count(
        padding: const EdgeInsets.all(20),
        crossAxisSpacing: 20,
        mainAxisSpacing: 20,
        crossAxisCount: args["columnCount"],
        children: Registry.getComponents(args["children"], context),
      ),
    );
  }
}
```

ì—¬ê¸°ì„œëŠ” `padding`, `crossAxisSpacing`, `mainAxisSpacing` í”„ë¡œí¼í‹°ë¥¼ ìƒìˆ˜ ê°’ìœ¼ë¡œ ì„¤ì •í–ˆì§€ë§Œ, ë§Œì•½ ì„œë²„ì—ì„œ ê´€ë¦¬í•˜ê³  ì‹¶ë‹¤ë©´ ê°„ë‹¨íˆ í•„ë“œë¥¼ ì¶”ê°€í•˜ê³  ê°’ì„ ë„£ì–´ì£¼ê¸°ë§Œ í•˜ë©´ ëœë‹¤. 

ì´ì œ ì„œë²„ì—ì„œ `GridView`ì˜ `children` í•„ë“œì— `TextButton` ë‘ ê°œë¥¼ ì‘ë‹µí•˜ë©´ í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ê·¸ëŒ€ë¡œ ë‘ ê°œì˜ ì…€ì— `TextButton`ì´ ë‹´ê¸´ í™”ë©´ì„ êµ¬ì„±í•œë‹¤. ê·¸ë¦¬ë“œì˜ ì—´ ê°œìˆ˜ë‚˜ ê° ì…€ì˜ ë‚´ìš©ì€ ì„œë²„ ì‘ë‹µì„ ìˆ˜ì •í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ì–¸ì œë“  ë³€ê²½í•  ìˆ˜ ìˆë‹¤. 

![Home, Sign in í™”ë©´ ìŠ¤í¬ë¦°ìƒ·.](/images/124346021-6a41fc80-dc17-11eb-8bf1-ef446ae0dfca.webp)

ì‹¤ì œ ë™ì‘í•˜ëŠ” ì½”ë“œëŠ” [github.com/parksb/server-driven-ui](https://github.com/parksb/server-driven-ui)ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë™ì‘ ë°©ì‹ì´ë‚˜ ê°œë…ì€ ì´ ê¸€ì—ì„œ ì„¤ëª…í•œ ê²ƒê³¼ ë™ì¼í•˜ì§€ë§Œ, ì»´í¬ë„ŒíŠ¸ ì¢…ë¥˜ë‚˜ êµ¬ì²´ì ì¸ í•„ë“œëŠ” ë‹¤ì†Œ ì°¨ì´ê°€ ìˆë‹¤. ë˜í•œ ì¹´ì¹´ì˜¤ìŠ¤íƒ€ì¼ì—ì„œë„ Server Driven UI ì„¤ê³„ë¥¼ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë°, [ì¹´ì¹´ì˜¤ìŠ¤íƒ€ì¼ ê¸°ìˆ  ë¸”ë¡œê·¸](https://devblog.croquis.com/ko/2021-12-16-1-server-driven-ui)ì—ì„œ ìì„¸íˆ ë³¼ ìˆ˜ ìˆë‹¤.

## References

* [ê¹€ë„í›ˆ, "Server Driven UI (Feat.Flutter)", 2020.](https://medium.com/@kimdohun0104/server-driven-ui-feat-flutter-87fcbb04e610)
* [ë°•í˜¸ì¤€, "GraphQLì´ ê°€ì ¸ì˜¨ ì—ì–´ë¹„ì•¤ë¹„ í”„ë¡ íŠ¸ì•¤ë“œ ê¸°ìˆ ì˜ ë³€ì²œì‚¬", DEVIEW 2020, 2020.](https://deview.kr/2020/sessions/337)
* [Tom Lokhorst, "Server Driven UI", Tom Lokhorst's blog, 2020.](http://tom.lokhorst.eu/2020/07/server-driven-ui)
* [Ryan Brroks, "A Deep Dive into Airbnbâ€™s Server-Driven UI System", 2021.](https://medium.com/airbnb-engineering/a-deep-dive-into-airbnbs-server-driven-ui-system-842244c5f5)

[^graphql-code]: [The GraphQL Foundation, "GraphQL Code Libraries, Tools and Services".](https://graphql.org/code/)
[^flutter-widget]: [Flutter, "Introduction to widgets".](https://flutter.dev/docs/development/ui/widgets-intro)
